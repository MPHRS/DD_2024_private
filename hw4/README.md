# Genome Assembly and Annotation Pipeline

## Описание

Этот пайплайн выполняет полный анализ данных секвенирования, включая контроль качества ридов, сборку генома, оценку его качества, аннотацию и поиск генов устойчивости и вирулентности. Используются следующие инструменты:

- **FastQC**: Контроль качества ридов.
- **SPAdes**: Сборка генома.
- **QUAST**: Оценка качества сборки.
- **Prokka**: Аннотация генома.
- **Abricate**: Поиск генов устойчивости и вирулентности.

---

## Структура файлов

- `samples.csv` — CSV-файл с описанием данных образцов. Формат:

```csv
sample_id,read_1,read_2,assembly
sample1,./test_input/SRR31122807_1.fastq,./test_input/SRR31122807_2.fastq,
sample2,./test_input/SRR31122801_1.fastq,./test_input/SRR31122801_2.fastq,./test_input/scaffolds_2.fasta

Поле assembly может быть пустым, если для образца нет предварительно собранного генома.

    main.nf — основной скрипт пайплайна Nextflow.
    nextflow.config — конфигурационный файл с параметрами среды выполнения.
    params.json — параметры для инструментов.
    test_input/ — директория с входными файлами (риды, сборки).
    test_output/ — директория для выходных данных.

Как запустить

    Убедитесь, что Nextflow установлен:

curl -s https://get.nextflow.io | bash

    Убедитесь, что установлены все необходимые инструменты: FastQC, SPAdes, QUAST, Prokka, Abricate.

    Запустите пайплайн с помощью команды:

nextflow run main.nf

    Для использования Docker:

nextflow run main.nf -with-docker

Выходные данные будут сохранены в директории test_output/.
Особенности
1. Поддержка образцов с предварительной сборкой (assembly)

Пайплайн автоматически разделяет образцы на:

    Собранные (with scaffolds): Используется существующий файл сборки (assembly).
    Несобранные (without scaffolds): Выполняется сборка с помощью SPAdes.

2. Основные этапы анализа

    FastQC: Контроль качества ридов для всех образцов.
    SPAdes: Сборка генома для образцов без готовой сборки.
    QUAST: Оценка качества сборки.
    Prokka: Аннотация геномов.
    Abricate: Поиск генов устойчивости и вирулентности.

3. Конфигурация

Файл nextflow.config позволяет задать:

    Использование Docker/Singularity.
    Количество потоков для параллельной обработки.
    Пути для входных и выходных данных.

Потоки данных
Чтение и разветвление образцов

    Образцы читаются из samples.csv.
    Канал данных разделяется на:
        with_scaffolds: Образцы с предварительно собранным геномом.
        without_scaffolds: Образцы без сборки, для которых требуется запуск SPAdes.

Последовательность процессов

    Для образцов без сборки:
        FastQC → SPAdes → QUAST → Prokka → Abricate.
    Для образцов с готовой сборкой:
        QUAST → Prokka → Abricate.

Пример конфигурации samples.csv

sample_id,read_1,read_2,assembly
sample1,./test_input/SRR31122807_1.fastq,./test_input/SRR31122807_2.fastq,
sample2,./test_input/SRR31122801_1.fastq,./test_input/SRR31122801_2.fastq,./test_input/scaffolds_2.fasta

После запуска пайплайна выходные данные будут сохранены в test_output/ с разделением по этапам анализа (fastqc, spades, quast, prokka, abricate).